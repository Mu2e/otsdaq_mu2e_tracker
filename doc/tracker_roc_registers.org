#+startup:unfold -*- buffer-read-only: t -*-
* --------------------------------------------------------------------------------------
* TODO Tracker ROC registers                                                         

- see TODO column

|----------+----------------------------------------------------------------------------------------+------|
| register | comment                                                                                | TODO |
|    (dec) |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       01 | always contains 0x1234 (for validation)                                                |      |
|          | if can't read, powercycle the ROC. Didn't help - powercycle the DTC                    |      |
|       04 | loopback coarse delay                                                                  |      |
|       06 | Bad Marker counter                                                                     |      |
|       07 | Fiber loss/lock counter, can't be reset in the software                                |      |
|       08 | "lane enable / pattern enable" register                                                |      |
|          | 0x0010: internal pattern generation mode                                               |      |
|          | 0x1010: different patterns: 5555 and aaaa                                              |      |
|          | 0x2010: ha                                                                             |      |
|          | 0x030f: 0x300 + DIGI lanes mask                                                        |      |
|          | -       0x0001: CAL lane 0                                                             |      |
|          | -       0x0002: CAL lane 1                                                             |      |
|          | -       0x0004: HV  lane 0                                                             |      |
|          | -       0x0008: HV  lane 1                                                             |      |
|       09 | r10<<16+r09 : num data requests seen                                                   |      |
|       10 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       11 | r12<<16+r11 : Num EWM seen                                                             |      |
|       12 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       13 | Num skipped DATA REQ                                                                   |      |
|       14 | reset, write 1 to r14 to reset the ROC                                                 |      |
|       16 | unused ....                                                                            |      |
|       18 | in digi mode 0x0f00 for reg_8 of 0x030f (repeats the lane mask)                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       23 | r24<<16+r23 : SIZE_FIFO_FULL [28]+STORE_POS[25:24]+STORE_CNT[19:0]                     |      |
|       24 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       25 | r26<<16+r25 : SIZE_FIFO_EMPTY[28]+FETCH_POS[25:24]+FETCH_CNT[19:0]                     |      |
|       26 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       27 | r28<<16+r27 : Num HB seen                                                              |      |
|          |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       29 | ROC data format, currently <2024-05-27 Mon> : 1                                        |      |
|       30 | mode, need to learn more                                                               |      |
|          | *on read* : r30<<16+r29 : Num null HB seen                                             | TODO |
|          | what is the mode ? - it has to be written in the beginning                             |      |
|          | write mode to 0x0030                                                                   |      |
|          | - mode (from Monica's script):                                                         |      |
|          | - 0: status bit = 0x55 what is it ?                                                    |      |
|          | - 1: STATUS_BIT_0=DREQ_EMPY, BIT_1=DREQ_FULL, BIT_2=ETFIFO_FULL, STATUS_BIT_3=DDR_WRAP |      |
|          | - 2: STATUS_BIT=DREQ_WRCNT                                                             |      |
|          | - 3: STATUS_BIT=EWM_COUNTER                                                            |      |
|----------+----------------------------------------------------------------------------------------+------|
|       31 | r32<<16+r31 :  Num HB on hold                                                          |      |
|       32 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       33 | r34<<16+r33 :                                                                          |      |
|       34 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       35 | r36<<16+r35 : Num DATA REQ written to DDR                                              |      |
|       36 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       37 | r38<<16+r37 : Num DATA REQ read from DDR                                               |      |
|       38 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       39 | r40<<16+r39 :                                                                          |      |
|       40 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       41 | r42<<16+r41 :                                                                          |      |
|       42 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       43 | r44<<16+r43 :                                                                          |      |
|       44 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       45 | r46<<16+r45 :  Last HB tag                                                             |      |
|       46 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       47 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       48 | r49<<16+r48 :                                                                          |      |
|       49 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       50 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       51 | r52<<16+r51 :                                                                          |      |
|       52 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       53 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       54 | r55<<16+r54 :                                                                          |      |
|       55 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       56 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       57 | r58<<16+r57 :                                                                          |      |
|       58 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       59 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       64 | r65<<16+r64 : Num windows seen        ?? see r11,12                                    |      |
|       65 |                                                                                        |      |
|----------+----------------------------------------------------------------------------------------+------|
|       72 | Num HB   tag inconsistencies  (8 bits)                                                 |      |
|       73 | Num DREQ tag inconsistencies  (8 bits)                                                 |      |
|       74 | Num HB   tag lost (8 bits)                                                             |      |
|       75 | Num DREQ tag lost (8 bits)                                                             |      |
|----------+----------------------------------------------------------------------------------------+------|
* --------------------------------------------------------------------------------------
* back to [[file:otsdaq_mu2e_tracker.org][otsdaq_mu2e_tracker.org]]
* --------------------------------------------------------------------------------------
